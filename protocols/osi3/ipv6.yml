---
protocol:
  name: ipv6
  osilayer: 3
  fields:
    - field: version
      bitfield: yes
      length: 4
    - field: trafficclass
      desc: traffic class
      bitfield: yes
      length: 8
    - field: flowlabel
      desc: flow label
      bitfield: yes
      length: 20
    - field: length
      desc: payload length
      length: 2
    - field: nextheader
      desc: next header identifier (see ipv4 protocol id)
      length: 1
      nextlayer: yes
    - field: hoplimit
      desc: hop limit
      length: 1
    - field: srcaddress
      desc: source address
      length: 16
    - field: dstaddress
      desc: destination address
      length: 16
  extensionreferencefield: nextheader
  extensions:
    - extension:
        name: hopbyhop 
        referenceid: 0
        fields: &hopbyhop
          - field: nextheader
            length: 1
            nextlayer: yes
          - field: extlength
            desc: Header extension lengthin octets
            length: 1
          - field: options
            length: 6
          - field: options
            length: 8
            optional: yes
            repeatable: yes
    - extension: 
        name: destoptions
        referenceid: 60
        fields: *hopbyhop
    - extension:
        name: routing #is deprecated (see http://en.wikipedia.org/wiki/IPv6_packet)
        referenceid: 43
        fields:
          - field: nextheader
            length: 1
            nextlayer: yes
          - field: extlength
            length: 1
          - field: routingtype
            length: 1
          - field: segmentsleft
            length: 1
          - field: typedata
            length: 4
          - field: typedata
            length: 8
            optional: yes
    - extension:
        name: fragment
        referenceid: 44
        fields:
          - field: nextheader
            length: 1
            nextlayer: yes
          - field: reserved
            length: 1
          - field: fragmentoffset
            bitfield: yes
            length: 13
          - field: reserved
            bitfield: yes
            length: 2
          - field: mflag
            bitfield: yes
            length: 1
          - field: identification
            length: 4